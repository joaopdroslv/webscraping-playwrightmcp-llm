services:
  playwright-mcp:
    image: mcr.microsoft.com/playwright/mcp:latest
    container_name: playwright-mcp
    init: true
    restart: unless-stopped
    ports:
      - "8931:8931"
    command:
      [
        "--browser", "chromium",
        "--headless",
        "--no-sandbox",
        "--ignore-https-errors",
        "--port", "8931",
        "--allowed-hosts", "*"
      ]
    shm_size: "2gb"

  workflow:
    build:
      context: .
      dockerfile: workflow.dockerfile
    container_name: workflow
    depends_on:
      - playwright-mcp
    volumes:
      - ./output:/app/output
    command: ["python", "-m", "code.main"]
